{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Deployment Configuration Schema",
  "description": "Configuration schema for the deployment system",
  "type": "object",
  "properties": {
    "deployment": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "environment": { "enum": ["development", "staging", "production"] },
        "retryAttempts": { "type": "number", "minimum": 0, "maximum": 10 },
        "retryDelay": { "type": "number", "minimum": 1000 }
      }
    },
    "timeouts": {
      "type": "object",
      "properties": {
        "buildTimeout": { "type": "number", "minimum": 60000 },
        "testTimeout": { "type": "number", "minimum": 30000 },
        "deploymentTimeout": { "type": "number", "minimum": 120000 },
        "healthCheckTimeout": { "type": "number", "minimum": 5000 },
        "apiTimeout": { "type": "number", "minimum": 3000 }
      }
    },
    "checks": {
      "type": "object",
      "properties": {
        "gitStatus": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "allowUntracked": { "type": "boolean" },
            "allowModified": { "type": "boolean" },
            "exceptions": {
              "type": "array",
              "items": { "type": "string" }
            }
          }
        },
        "dependencies": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "checkOutdated": { "type": "boolean" },
            "checkVulnerabilities": { "type": "boolean" },
            "autoUpdate": { "type": "boolean" },
            "allowedVulnerabilities": {
              "type": "array",
              "items": { "enum": ["low", "moderate", "high", "critical"] }
            }
          }
        },
        "typescript": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "strict": { "type": "boolean" },
            "autoFix": { "type": "boolean" },
            "ignorePaths": {
              "type": "array",
              "items": { "type": "string" }
            }
          }
        },
        "linting": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "autoFix": { "type": "boolean" },
            "failOnWarning": { "type": "boolean" },
            "ignorePaths": {
              "type": "array",
              "items": { "type": "string" }
            }
          }
        },
        "tests": {
          "type": "object",
          "properties": {
            "unit": {
              "type": "object",
              "properties": {
                "enabled": { "type": "boolean" },
                "required": { "type": "boolean" },
                "coverageThreshold": { "type": "number", "minimum": 0, "maximum": 100 },
                "parallelJobs": { "type": "number", "minimum": 1 }
              }
            },
            "integration": {
              "type": "object",
              "properties": {
                "enabled": { "type": "boolean" },
                "required": { "type": "boolean" },
                "timeout": { "type": "number", "minimum": 10000 }
              }
            },
            "e2e": {
              "type": "object",
              "properties": {
                "enabled": { "type": "boolean" },
                "required": { "type": "boolean" },
                "browsers": {
                  "type": "array",
                  "items": { "enum": ["chromium", "firefox", "webkit"] }
                },
                "headless": { "type": "boolean" }
              }
            }
          }
        },
        "build": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "analyze": { "type": "boolean" },
            "bundleSizeLimit": { "type": "string" },
            "optimizations": {
              "type": "object",
              "properties": {
                "minify": { "type": "boolean" },
                "treeshake": { "type": "boolean" },
                "splitChunks": { "type": "boolean" }
              }
            }
          }
        },
        "security": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "scanDependencies": { "type": "boolean" },
            "scanCode": { "type": "boolean" },
            "blockHighSeverity": { "type": "boolean" },
            "allowedLicenses": {
              "type": "array",
              "items": { "type": "string" }
            }
          }
        },
        "healthChecks": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "endpoints": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": { "type": "string" },
                  "url": { "type": "string" },
                  "expectedStatus": { "type": "number" },
                  "timeout": { "type": "number" }
                },
                "required": ["name", "url", "expectedStatus"]
              }
            }
          }
        }
      }
    },
    "autoFix": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "rules": {
          "type": "object",
          "properties": {
            "prettier": { "type": "boolean" },
            "eslint": { "type": "boolean" },
            "typescript": { "type": "boolean" },
            "packageJson": { "type": "boolean" },
            "lockFile": { "type": "boolean" }
          }
        },
        "commitMessage": { "type": "string" },
        "maxAttempts": { "type": "number", "minimum": 1 }
      }
    },
    "notifications": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "channels": {
          "type": "object",
          "properties": {
            "console": { "type": "boolean" },
            "file": { "type": "boolean" },
            "slack": { "type": "boolean" },
            "email": { "type": "boolean" }
          }
        },
        "events": {
          "type": "object",
          "properties": {
            "deploymentStart": { "type": "boolean" },
            "deploymentSuccess": { "type": "boolean" },
            "deploymentFailure": { "type": "boolean" },
            "testsFailure": { "type": "boolean" },
            "buildFailure": { "type": "boolean" }
          }
        }
      }
    },
    "rollback": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "automatic": { "type": "boolean" },
        "maxVersions": { "type": "number", "minimum": 1 },
        "healthCheckFailures": { "type": "number", "minimum": 1 }
      }
    },
    "features": {
      "type": "object",
      "properties": {
        "parallelChecks": { "type": "boolean" },
        "incrementalBuilds": { "type": "boolean" },
        "cacheOptimization": { "type": "boolean" },
        "smartRetry": { "type": "boolean" },
        "verboseLogging": { "type": "boolean" },
        "dryRun": { "type": "boolean" }
      }
    },
    "customScripts": {
      "type": "object",
      "properties": {
        "preDeploy": {
          "type": "array",
          "items": { "type": "string" }
        },
        "postDeploy": {
          "type": "array",
          "items": { "type": "string" }
        },
        "onFailure": {
          "type": "array",
          "items": { "type": "string" }
        },
        "onSuccess": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    }
  }
}